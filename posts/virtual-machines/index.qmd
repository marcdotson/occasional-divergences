---
title: "Spinning up virtual machines for R and Python"
author: "Marc Dotson"
date: "2024-09-31"
description: |
  Setting up and using virtual machines to break through computational bottlenecks can be challenging. This post is a gentle introduction.
categories:
  - r
  - python
  - stan
  - positron
image: figures/owl.png
slug: virtual-machines
---

It's not uncommon to run into computational bottlenecks when running models, Bayesian or otherwise. I've often had access to a dedicated computer or server for such tasks or, in classic academic fashion, I've been comfortable with letting models run for weeks. But these options aren't always available and they might not actually solve the problem. Cloud computing is clearly the solution. However, breaking into using cloud computing can make you feel the need to adapt the adage often applied to needing regular expressions: "If you have a problem that requires cloud computing, congratulations, you now have two problems."

There are a number of cloud service providers, AWS arguably chief among them. However, AWS can do *everything* when what I really need is the ability to quickly spin up and temporarily use a virtual machine that can easily run R and/or Python along with Stan. One of the primary reason VS Code has been so hyped is the use of a SSH extension for easily tunneling into and using such a virtual machine. However, the virtual machine needs to be spun up in the first place. This definitely feels like a *draw the rest of the owl* situation.

![](figures/owl.png){width=50% fig-align="center"}

In this post, I try to fill in the gaps and provide a gentle introduction to spinning up and using virtual machines. Special thanks to Lizzy Nguyen and Andrew Heiss for helping me navigate all of this.

## Setting up a VM

Where is it easy to spin up a VM using a docker container?! AWS, Azure, Google Cloud, Digital Ocean, Linode, Posit Workbench, Databricks, Snowflake?

Does scaling the RAM happen automatically?

AWS, like Azure and GCP (is it too general)? Can use AWS for *anything*. App hosting, etc. Including using GPU clusters and quantum computing! Cutting a cake with a chainsaw.

- Andrew Brown's AWS Certified Cloud Practitioner Certification Course: https://www.youtube.com/watch?v=SOTamWNgDKc&list=PLWKjhJtqVAbkzvvpY12KkfiIGso9A_Ixs&index=2
- Elastic Compute Cloud (EC2) for VM or Elastic Constainer Service (ECS) for an EC2 instance with Docker installed.
- What about higher performance computing services (HPC)? Does it only come in clusters? Would I need to use CloudShell?
- S3/RDS for storage.
- Do I need to have two VMs, one for storage and one for compute?
- Have to pick an OS, instance type, add storage...
- Memory optimized (large data sets in memory)

Digital Ocean? From Andrew:



## Using Docker Compose?

Do I need to figure out Docker Compose in order to set up a VM?

Containers don't have as much wasted space as a VM -- you can have many containers running on a VM.

- Andrew's old blog post: https://www.andrewheiss.com/blog/2017/04/27/super-basic-practical-guide-to-docker-and-rstudio/index.html
- VS Code Hype (including Docker Compose, Azure, AWS extensions): https://www.youtube.com/watch?v=1ZfO149BJvg

Or I can use an existing Docker image:

- Here's an example from Andrew using R, Python, and Quarto: https://github.com/andrewheiss/example-r-python-quarto-docker
- Here's one for just R and VS Code: https://github.com/RamiKrispin/vscode-r

Andrew likes to mount local folders to the docker container so he knows where everything rather than use official dev envirnoment tools that have more opaque file systems. That said, most of his work is for testing things for package development, not for computational resources.

## Tunneling with SSH

SSH Tunneling with VS Code:

- https://www.youtube.com/watch?v=cOopQQIL8JU
- 

## Final thoughts

Is it available yet in Positron? Otherwise available for R and Python?

